<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🌿 스마트 방형구법 탐구</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

<header>
    <h1>🌿 스마트 식물 군집 조사</h1>
    <p>AI로 식물을 찾고, 데이터를 분석해 우점종을 찾아봅시다.</p>
</header>

<main class="container">

    <section id="ai-section" class="card">
        <h2>📷 STEP 1. AI 식물 인식 도우미</h2>
        <p class="guide-text">이 식물의 이름이 헷갈리나요? 카메라를 비춰보세요.</p>
        
        <div class="camera-container">
            <div id="webcam-container">카메라 로딩 대기 중...</div>
            <div id="label-container"></div>
        </div>
        
        <div class="controls">
            <button id="startBtn" onclick="init()" class="btn-primary">▶ 카메라 켜기</button>
        </div>
    </section>


    <section id="calculator-section" class="card">
        <h2>📝 STEP 2. 방형구법 데이터 기록</h2>
        <p class="guide-text">조사한 데이터를 입력하면 우점종이 자동 계산됩니다.</p>

        <div class="input-group">
            <label for="totalQuadrats">전체 방형구 설치 수(개): </label>
            <input type="number" id="totalQuadrats" value="10" min="1">
        </div>
        
        <div class="table-responsive">
        <table id="inputTable">
            <thead>
                <tr>
                    <th>식물 종 이름</th>
                    <th>총 개체수<br>(밀도용)</th>
                    <th>출현 방형구 수<br>(빈도용)</th>
                    <th>평균 피도계급<br>(1~5)</th>
                    <th>삭제</th>
                </tr>
            </thead>
            <tbody>
                </tbody>
        </table>
        </div>

        <div class="controls table-controls">
            <button onclick="addRow()" class="btn-secondary">+ 종 추가하기</button>
            <button onclick="calculate()" class="btn-primary">📊 분석 시작 & 우점종 확인</button>
        </div>
    </section>


    <section id="result-section" class="card" style="display:none;">
        <h2>🏆 STEP 3. 최종 분석 결과</h2>
        
        <div id="dominant-result" class="highlight-box">
            </div>

        <div class="table-responsive">
        <table id="resultTable">
            <thead>
                <tr>
                    <th>순위</th>
                    <th>종 이름</th>
                    <th>상대밀도(%)</th>
                    <th>상대빈도(%)</th>
                    <th>상대피도(%)</th>
                    <th>중요치(IV)</th>
                </tr>
            </thead>
            <tbody id="resultBody">
                </tbody>
        </table>
        </div>

        <div class="controls">
             <button onclick="downloadCSV()" class="btn-download">💾 엑셀(CSV)로 결과 저장하기</button>
             <p class="guide-text small">저장된 파일을 AI에게 업로드하여 심층 분석을 의뢰해보세요!</p>
        </div>
    </section>

</main>

<footer>
    <p>© 2024 생명과학 탐구 수업 도구</p>
</footer>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/teachablemachine-image@latest/dist/teachablemachine-image.min.js"></script>
<script src="script.js"></script>

</body>
</html>